{
    "docs": [
        {
            "location": "/", 
            "text": "HESS\n\n\nHESS (Heritability Estimation from Summary Statistics) is a software package\nfor estimating and visualizing local SNP-heritability and genetic covariance\n(correlation) from GWAS summary association data. The latest version is\n\nversion 0.5.3-beta\n.\nReference panel can be downloaded \nhere\n.\n\n\nSoftware requirement\n\n\nFor running HESS\n\n\n\n\nPython 2.7\n\n\nNumPy 1.9+\n\n\nPandas 0.18+\n\n\nPySnpTools 0.3+\n\n\nSciPy 0.16+\n\n\n\n\nFor running analysis and visualization tools\n\n\n\n\nPython 2.7\n\n\nNumPy 1.9+\n\n\nPandas 0.18+\n\n\nMatplotlib 1.4+\n\n\nSciPy 0.16+\n\n\n\n\n\n( \nNote\n: It is important to use the latest version of NumPy, which is\nmore numerically stable when performing eigendecomposition of the LD\nmatrix. Python 3.0+ may not work well ith HESS, which is written and tested\nin Python 2.7.3. )\n\n\n\n\nReferences\n\n\n\n\nLocal SNP-heritability\n: \nShi, Huwenbo, Gleb Kichaev, and Bogdan Pasaniuc. \"Contrasting the genetic architecture of 30 complex traits from summary association data.\" The American Journal of Human Genetics 99, no. 1 (2016): 139-153.\n\n\nLocal genetic covariance (correlation)\n: \nShi, Huwenbo, Nicholas Mancuso, Sarah Spendlove, and Bogdan Pasaniuc. \"Local genetic correlation gives insights into the shared genetic architecture of complex traits.\" The American Journal of Human Genetics 101, no. 5 (2017): 737-751.\n\n\n\n\nContact\n\n\n\n\nHuwenbo Shi\n: shihuwenbo_AT_ucla.edu\n\n\nBogdan Pasaniuc\n: bpasaniuc_AT_mednet.ucla.edu", 
            "title": "Home"
        }, 
        {
            "location": "/#hess", 
            "text": "HESS (Heritability Estimation from Summary Statistics) is a software package\nfor estimating and visualizing local SNP-heritability and genetic covariance\n(correlation) from GWAS summary association data. The latest version is version 0.5.3-beta .\nReference panel can be downloaded  here .", 
            "title": "HESS"
        }, 
        {
            "location": "/#software-requirement", 
            "text": "", 
            "title": "Software requirement"
        }, 
        {
            "location": "/#for-running-hess", 
            "text": "Python 2.7  NumPy 1.9+  Pandas 0.18+  PySnpTools 0.3+  SciPy 0.16+", 
            "title": "For running HESS"
        }, 
        {
            "location": "/#for-running-analysis-and-visualization-tools", 
            "text": "Python 2.7  NumPy 1.9+  Pandas 0.18+  Matplotlib 1.4+  SciPy 0.16+   \n(  Note : It is important to use the latest version of NumPy, which is\nmore numerically stable when performing eigendecomposition of the LD\nmatrix. Python 3.0+ may not work well ith HESS, which is written and tested\nin Python 2.7.3. )", 
            "title": "For running analysis and visualization tools"
        }, 
        {
            "location": "/#references", 
            "text": "Local SNP-heritability :  Shi, Huwenbo, Gleb Kichaev, and Bogdan Pasaniuc. \"Contrasting the genetic architecture of 30 complex traits from summary association data.\" The American Journal of Human Genetics 99, no. 1 (2016): 139-153.  Local genetic covariance (correlation) :  Shi, Huwenbo, Nicholas Mancuso, Sarah Spendlove, and Bogdan Pasaniuc. \"Local genetic correlation gives insights into the shared genetic architecture of complex traits.\" The American Journal of Human Genetics 101, no. 5 (2017): 737-751.", 
            "title": "References"
        }, 
        {
            "location": "/#contact", 
            "text": "Huwenbo Shi : shihuwenbo_AT_ucla.edu  Bogdan Pasaniuc : bpasaniuc_AT_mednet.ucla.edu", 
            "title": "Contact"
        }, 
        {
            "location": "/input_format/", 
            "text": "Input Format\n\n\nThis page describes the format of the GWAS summary association data (supplied\nthrough the \n--local-hsqg\n or \n--local-rhog\n flag), genome partition file\n(supplied through the \n--partition\n flag) and the reference panel required\nby HESS (supplied through the \n--bfile\n format).\n\n\nGWAS summary association data\n\n\nHESS requires a single file in plain text or gzipped text containing the\nfollowing columns to be present in the GWAS summary association data:\n\n\n\n\nSNP - rs ID of the SNP (e.g. rs62442).\n\n\nCHR - Chromosome number of the SNP. This should be a number between 1 and 22.\n\n\nBP - Base pair position of the SNP.\n\n\nA1 - Effect allele of the SNP. The sign of the Z-score is with respect to this allele.\n\n\nA2 - The other allele of the SNP.\n\n\nZ - The Z-score of the SNP.\n\n\nN - Sample size of the SNP.\n\n\n\n\nFor estimating local SNP-heritability, one summary statistics file should be\nsupplied through the \n--local-hsqg\n flag. For estimating local genetic\ncovariance, two summary statistics files should be supplied through\nthe \n--local-rhog\n flag.\n\n\n\n( \nNote\n:  This file format is compatible with \nLDSC\n.\nHowever, HESS requires two additional columns than LDSC [CHR and BP].\nTherefore, one may not directly run HESS on summary stats in LDSC format\nunless these two columns are provided. Other columns [e.g. MAF, INFO, etc.]\nmay be included in the file, but will not be used. It is also recommended\n[although not required] that the summary data files are sorted by their\nchromosomes and base pairs. All SNPs with either duplicate ID or position\nwill be removed before any analysis. )\n\n\n\n\n\n( \nNote\n: We recommend to run HESS on imputed summary statistics data.\nHESS may yield downwardly biased estimates when only genotyped SNPs are used. )\n\n\n\n\nGenome partition\n\n\nThe genome partition file should be in bed format, one for each chromosome. We\nrecommend to use the approximately LD-independent loci provided by Berisa\net al., which can be downloaded \nhere\n.\nPlease choose the genome partition that corresponds to the GWAS population.\nThe genome partition file is supplied through the \n--partition\n flag.\n\n\n\n( \nNote\n: In order to obtain unbiased estimates, the partitions should be as\nLD-independent as possible. Using a small window may result in LD leakage and\nbiased estimates. )\n\n\n\n\nReference panel\n\n\nReference panels should be in \nPLINK format\n\n(supplied through the \n--bfile\n flag).\n\n\nThe following is a list of popular publicly available reference panels.\n\n\n\n\n1000 Genomes Project\n\n\nUK10K\n\n\n\n\nWe provide 1000 Genomes reference panel for Europeans \nhere\n.\nAll SNPs in this reference panel have minor allele frequency greater than 1%.\n\n\n\n( \nNote\n: If a SNP has missing genotypes at some individuals in the\nreference panel, HESS imputes the missing value with the population average.\nHESS also removes all SNPs with duplicate ID or position. )", 
            "title": "Input Format"
        }, 
        {
            "location": "/input_format/#input-format", 
            "text": "This page describes the format of the GWAS summary association data (supplied\nthrough the  --local-hsqg  or  --local-rhog  flag), genome partition file\n(supplied through the  --partition  flag) and the reference panel required\nby HESS (supplied through the  --bfile  format).", 
            "title": "Input Format"
        }, 
        {
            "location": "/input_format/#gwas-summary-association-data", 
            "text": "HESS requires a single file in plain text or gzipped text containing the\nfollowing columns to be present in the GWAS summary association data:   SNP - rs ID of the SNP (e.g. rs62442).  CHR - Chromosome number of the SNP. This should be a number between 1 and 22.  BP - Base pair position of the SNP.  A1 - Effect allele of the SNP. The sign of the Z-score is with respect to this allele.  A2 - The other allele of the SNP.  Z - The Z-score of the SNP.  N - Sample size of the SNP.   For estimating local SNP-heritability, one summary statistics file should be\nsupplied through the  --local-hsqg  flag. For estimating local genetic\ncovariance, two summary statistics files should be supplied through\nthe  --local-rhog  flag.  \n(  Note :  This file format is compatible with  LDSC .\nHowever, HESS requires two additional columns than LDSC [CHR and BP].\nTherefore, one may not directly run HESS on summary stats in LDSC format\nunless these two columns are provided. Other columns [e.g. MAF, INFO, etc.]\nmay be included in the file, but will not be used. It is also recommended\n[although not required] that the summary data files are sorted by their\nchromosomes and base pairs. All SNPs with either duplicate ID or position\nwill be removed before any analysis. )  \n(  Note : We recommend to run HESS on imputed summary statistics data.\nHESS may yield downwardly biased estimates when only genotyped SNPs are used. )", 
            "title": "GWAS summary association data"
        }, 
        {
            "location": "/input_format/#genome-partition", 
            "text": "The genome partition file should be in bed format, one for each chromosome. We\nrecommend to use the approximately LD-independent loci provided by Berisa\net al., which can be downloaded  here .\nPlease choose the genome partition that corresponds to the GWAS population.\nThe genome partition file is supplied through the  --partition  flag.  \n(  Note : In order to obtain unbiased estimates, the partitions should be as\nLD-independent as possible. Using a small window may result in LD leakage and\nbiased estimates. )", 
            "title": "Genome partition"
        }, 
        {
            "location": "/input_format/#reference-panel", 
            "text": "Reference panels should be in  PLINK format \n(supplied through the  --bfile  flag).  The following is a list of popular publicly available reference panels.   1000 Genomes Project  UK10K   We provide 1000 Genomes reference panel for Europeans  here .\nAll SNPs in this reference panel have minor allele frequency greater than 1%.  \n(  Note : If a SNP has missing genotypes at some individuals in the\nreference panel, HESS imputes the missing value with the population average.\nHESS also removes all SNPs with duplicate ID or position. )", 
            "title": "Reference panel"
        }, 
        {
            "location": "/local_hsqg/", 
            "text": "Estimating local SNP-heritability\n\n\nThis page describes the steps to estimate local SNP-heritability from GWAS\nsummary association data. In the first step, HESS computes the eigenvalues of\nLD matrices, and the squared projections of GWAS effect size vector onto the\neigenvectors of LD matrices. In the second step, HESS uses the output from\nstep 1 to obtain estimates of local SNP-heritability and their standard errors.\n\n\nStep 1 - compute eigenvalues and squared projections\n\n\nRunning the tool\n\n\nIn this step, HESS computes the eigenvalues, and the squared projections of\nGWAS effect size vector onto the eigenvectors of LD matrices. The following\ncode provides an example of how to perform this tep.\n\n\nfor chrom in $(seq 22)\ndo\n    python hess.py \\\n        --local-hsqg \nsummary statistics\n \\\n        --chrom $chrom \\\n        --bfile \nreference panel in PLINK format for the specific chromosome\n \\\n        --partition \ngenome partition file for the specific chromosome\n \\\n        --out step1\ndone\n\n\n\n\n\nIn the command above, \n--local-hsqg\n tells HESS to estimate local\nSNP-heritability, and is used to specify the GWAS summary statistics data;\n\n--chrom\n is used to specify the chromosome number; \n--bfile\n is used to\nspecify the reference panel for the corresponding chromsome; \n--partition\n is\nused to specify the genome partition file; \n--out\n is used to specify the\nprefix of the output file. For input file format, please refer to\n\nInput Format\n.\n\n\n\n( \nNote\n: The above for loop can be parallelized by chromosome in case a\ncomputer cluster is available. In addition, users can specify the minimum\nminor allele frequency (MAF) of the SNPs used for estimation through the\n\"--min-maf\" flag. The default MAF threshold is 0.05. )\n\n\n\n\nInterpreting the output\n\n\nAfter executing the command above, 4 files will be created for each\nchromosome (i.e. 88 files for all 22 chromosomes in total), taking up ~10MB\nof space for the entire genome. The following is an example output obtained\nfor chromosome 22.\n\n\n\n\nstep1_chr22.info.gz\n - contains the locus information, including start and end\npositions, number of SNPs, rank of LD matrices, and sample size\n\n\n\n\n16050408        17674294        371     274     91273\n17674295        18296087        419     306     89182\n18296088        19912357        947     502     90231\n...             ...             ...     ...     ...\n\n\n\n\n\n\n\nstep1_chr22.eig.gz\n - contains the eigenvalues of LD matrix (up to the rank\nof the LD matrix) at each locus, one line per locus\n\n\n\n\n39.31792281  31.23990243  23.81549256  23.47296559  20.45343550  ...\n48.73186142  26.95692375  25.32769526  22.11750791  20.55766423  ...\n82.58157342  67.42588424  59.52766188  43.10471854  32.15181631  ...\n...          ...          ...          ...          ...          ...\n\n\n\n\n\n\n\nstep1_chr22.prjsq.gz\n - contains the squared projections of GWAS effect size\nvector onto the eigenvectors of LD matrix (up to the rank of the LD matrix) at\neach locus, one line per locus\n\n\n\n\n0.00008940  0.00001401  0.00013805  0.00009906  0.00007841  ...\n0.00054948  0.00001756  0.00008532  0.00002303  0.00004706  ...\n0.00008693  0.00005737  0.00070234  0.00008411  0.00004001  ...\n...         ...         ...         ...         ...         ...\n\n\n\n\n\n\n\nstep1_chr22.log\n - contains helpful information for debugging, including\nnumber of SNPs, number of SNPs filtered, etc.\n\n\n\n\n[INFO] Command started at: ...\n[INFO] Command issued: ...\n[INFO] Loaded ... partitins in ...\n[INFO] Average window size is ...\n[INFO] ... SNPs read from reference panel\n                     ...\n[INFO] Command finished at: ...\n\n\n\n\n\n\n( \nNote\n: Log files are very useful in solving issues with running the\nsoftware. Please include the log file in the email when you report any issue\nwith HESS. )\n\n\n\n\nStep 2 - estimate local SNP-heritability and standard error\n\n\nRunning the tool (without using total SNP-heritability)\n\n\nIn the second step, HESS uses output from step 1 across all chromosomes\n(step1_chr{1..22}.info.gz, step1_chr{1..22}.eig.gz, step1_chr{1..22}.prjsq.gz)\nto obtain local SNP-heritability estimates and their standard errors. The\nfollowing command automatically looks for output from step 1 across all\nchromosomes with the prefix \"step1\" to obtain local SNP-heritability estimates.\n\n\npython hess.py --prefix step1 --out step2\n\n\n\n\n\n\n( \nNote\n: This is the recommended way of running HESS. However, if sample\nsize of the GWAS is relatively small and total SNP-heritability is known, e.g.\nestimated from individual-level data, then one may use the script in the\nnext section to obtain local SNP-heritability estimates. Also note that no\nfor loop is needed here. )\n\n\n\n\nNote on re-inflating \\(\\lambda_{GC}\\)\n\n\nMost GWAS summary stats are corrected for genomic control factor\n\\(\\lambda_{GC}\\). This could result in a downward bias in the estimated\nSNP-heritability. If the GWAS summary stats has been corrected for\n\\(\\lambda_{GC}\\), it is recommended to use the following code to perform\nstep 2.\n\n\npython hess.py --prefix step1 --reinflate-lambda-gc \nlambda gc to reinflate\n \\\n               --out step2\n\n\n\n\n\nRunning the tool (using total SNP-heritability)\n\n\nIf sample size of the GWAS is relatively small, the standard error of total\nSNP-heritability estimates of HESS can be large, which could then lead to\nlarge standard error in the local estimates. However, if an estimate of total\nSNP-heritability is available, then one may use the following script to\ndecompose the total SNP-heritability into each locus.\n\n\npython hess.py --prefix step1 --tot-hsqg \ntotal SNP-heritability\n \nSE\n --out step2\n\n\n\n\n\nIt is recommended to use the following code if the GWAS summary stats are\ncorrected for \\(\\lambda_{GC}\\).\n\n\npython hess.py --prefix step1 --reinflate-lambda-gc \nlambda gc to reinflate\n \\\n               --tot-hsqg \ntotal SNP-heritability\n \nSE\n --out step2\n\n\n\n\n\nOther available flags\n\n\n\n\n--max-num-eig\n: Specifies the number of eigenvectors to use in the\ntruncated-SVD for inverting the LD matrix, default 50\n\n\n--min-eigval\n: Specifies the minimum eigenvalue cut off in\ntruncated-SVD, default 1.0\n\n\n--reinflate-lambda-gc\n: Specifies the genomic control factor that has been\napplied to the summary statistics, default 1.0\n\n\n--gwse-thres\n: A threshold to cap the standard error of total\nSNP-heritability estimate\n\n\n\n\n\n( \nNote\n: We recommend to run HESS on GWAS summary statistics that has\nnot been applied the genomic control factor, which could results in downward\nbias. )\n\n\n\n\nWe provide a simple script (\nmisc/estimate_lambdagc.py\n) to infer the genomic\ncontrol factor to reinflate the summary statistics if it is unknown. The\nfollowing script should be executed after step 1 completes.\n\n\npython misc/estimate_lambdagc.py --prefix step1\n\n\n\n\n\nInterpreting the output\n\n\nAfter step 2, 2 files will be created. These include\n\n\n\n\nstep2.txt\n: contains local SNP-heritability estimates for all loci across all\nchromosomes. The columns are chromosome number, locus start position, locus\nend position, number of SNPs in locus, number of eigenvectors used\nin truncated-SVD, estimates of local SNP-heritability, estimated variance\nof the local SNP-heritability. We also report standard error and test\nstatistics.\n\n\n\n\nchr start       end         num_snp k   local_h2g   var         se          z           p\n1   10583       1892607     1286    50  0.0001293   1.2819e-08  0.00011322  1.142       0.12673\n1   1892607     3582736     3045    50  0.0003232   2.7102e-08  0.00016463  1.9632      0.024809\n1   3582736     4380811     1622    50  6.7587e-05  1.282e-08   0.00011323  0.59692     0.27528\n1   4380811     5913893     3790    50  3.1445e-05  2.6111e-08  0.00016159  0.1946      0.42285\n... ...         ...         ...     ... ...         ...         ...         ...         ...\n22  46470495    47596318    2444    50  0.00018004  2.0125e-08  0.00014186  1.2691      0.1022\n22  47596318    48903703    2997    50  8.389e-05   2.4784e-08  0.00015743  0.53287     0.29706\n22  48903703    49824534    3773    50  6.9487e-06  2.5931e-08  0.00016103  0.043151    0.48279\n22  49824534    51243298    2789    50  0.00015227  2.4024e-08  0.000155    0.98241     0.16295\n\n\n\n\n\n\n\nstep2.log\n: contains useful information for debugging\n\n\n\n\n[INFO] Command started at: Tue, 03 Oct 2017 21:01:34\n[INFO] Command issued:\n    /u/project/pasaniuc/shihuwen/software/hess/hess.py \\\n        --prefix ... \\\n        --out ...\n[INFO] Loaded results for ... loci from step 1\n[INFO] Using 4381458 SNPs with average sample size ...\n[INFO] Re-inflate the summary statistics with lambda_gc: ...\n[INFO] Total SNP-heritability estimate: ...\n[INFO] Command finished at: ...", 
            "title": "Local SNP-heritability"
        }, 
        {
            "location": "/local_hsqg/#estimating-local-snp-heritability", 
            "text": "This page describes the steps to estimate local SNP-heritability from GWAS\nsummary association data. In the first step, HESS computes the eigenvalues of\nLD matrices, and the squared projections of GWAS effect size vector onto the\neigenvectors of LD matrices. In the second step, HESS uses the output from\nstep 1 to obtain estimates of local SNP-heritability and their standard errors.", 
            "title": "Estimating local SNP-heritability"
        }, 
        {
            "location": "/local_hsqg/#step-1-compute-eigenvalues-and-squared-projections", 
            "text": "", 
            "title": "Step 1 - compute eigenvalues and squared projections"
        }, 
        {
            "location": "/local_hsqg/#running-the-tool", 
            "text": "In this step, HESS computes the eigenvalues, and the squared projections of\nGWAS effect size vector onto the eigenvectors of LD matrices. The following\ncode provides an example of how to perform this tep.  for chrom in $(seq 22)\ndo\n    python hess.py \\\n        --local-hsqg  summary statistics  \\\n        --chrom $chrom \\\n        --bfile  reference panel in PLINK format for the specific chromosome  \\\n        --partition  genome partition file for the specific chromosome  \\\n        --out step1\ndone  In the command above,  --local-hsqg  tells HESS to estimate local\nSNP-heritability, and is used to specify the GWAS summary statistics data; --chrom  is used to specify the chromosome number;  --bfile  is used to\nspecify the reference panel for the corresponding chromsome;  --partition  is\nused to specify the genome partition file;  --out  is used to specify the\nprefix of the output file. For input file format, please refer to Input Format .  \n(  Note : The above for loop can be parallelized by chromosome in case a\ncomputer cluster is available. In addition, users can specify the minimum\nminor allele frequency (MAF) of the SNPs used for estimation through the\n\"--min-maf\" flag. The default MAF threshold is 0.05. )", 
            "title": "Running the tool"
        }, 
        {
            "location": "/local_hsqg/#interpreting-the-output", 
            "text": "After executing the command above, 4 files will be created for each\nchromosome (i.e. 88 files for all 22 chromosomes in total), taking up ~10MB\nof space for the entire genome. The following is an example output obtained\nfor chromosome 22.   step1_chr22.info.gz  - contains the locus information, including start and end\npositions, number of SNPs, rank of LD matrices, and sample size   16050408        17674294        371     274     91273\n17674295        18296087        419     306     89182\n18296088        19912357        947     502     90231\n...             ...             ...     ...     ...   step1_chr22.eig.gz  - contains the eigenvalues of LD matrix (up to the rank\nof the LD matrix) at each locus, one line per locus   39.31792281  31.23990243  23.81549256  23.47296559  20.45343550  ...\n48.73186142  26.95692375  25.32769526  22.11750791  20.55766423  ...\n82.58157342  67.42588424  59.52766188  43.10471854  32.15181631  ...\n...          ...          ...          ...          ...          ...   step1_chr22.prjsq.gz  - contains the squared projections of GWAS effect size\nvector onto the eigenvectors of LD matrix (up to the rank of the LD matrix) at\neach locus, one line per locus   0.00008940  0.00001401  0.00013805  0.00009906  0.00007841  ...\n0.00054948  0.00001756  0.00008532  0.00002303  0.00004706  ...\n0.00008693  0.00005737  0.00070234  0.00008411  0.00004001  ...\n...         ...         ...         ...         ...         ...   step1_chr22.log  - contains helpful information for debugging, including\nnumber of SNPs, number of SNPs filtered, etc.   [INFO] Command started at: ...\n[INFO] Command issued: ...\n[INFO] Loaded ... partitins in ...\n[INFO] Average window size is ...\n[INFO] ... SNPs read from reference panel\n                     ...\n[INFO] Command finished at: ...  \n(  Note : Log files are very useful in solving issues with running the\nsoftware. Please include the log file in the email when you report any issue\nwith HESS. )", 
            "title": "Interpreting the output"
        }, 
        {
            "location": "/local_hsqg/#step-2-estimate-local-snp-heritability-and-standard-error", 
            "text": "", 
            "title": "Step 2 - estimate local SNP-heritability and standard error"
        }, 
        {
            "location": "/local_hsqg/#running-the-tool-without-using-total-snp-heritability", 
            "text": "In the second step, HESS uses output from step 1 across all chromosomes\n(step1_chr{1..22}.info.gz, step1_chr{1..22}.eig.gz, step1_chr{1..22}.prjsq.gz)\nto obtain local SNP-heritability estimates and their standard errors. The\nfollowing command automatically looks for output from step 1 across all\nchromosomes with the prefix \"step1\" to obtain local SNP-heritability estimates.  python hess.py --prefix step1 --out step2  \n(  Note : This is the recommended way of running HESS. However, if sample\nsize of the GWAS is relatively small and total SNP-heritability is known, e.g.\nestimated from individual-level data, then one may use the script in the\nnext section to obtain local SNP-heritability estimates. Also note that no\nfor loop is needed here. )", 
            "title": "Running the tool (without using total SNP-heritability)"
        }, 
        {
            "location": "/local_hsqg/#note-on-re-inflating-92lambda_gc92", 
            "text": "Most GWAS summary stats are corrected for genomic control factor\n\\(\\lambda_{GC}\\). This could result in a downward bias in the estimated\nSNP-heritability. If the GWAS summary stats has been corrected for\n\\(\\lambda_{GC}\\), it is recommended to use the following code to perform\nstep 2.  python hess.py --prefix step1 --reinflate-lambda-gc  lambda gc to reinflate  \\\n               --out step2", 
            "title": "Note on re-inflating \\(\\lambda_{GC}\\)"
        }, 
        {
            "location": "/local_hsqg/#running-the-tool-using-total-snp-heritability", 
            "text": "If sample size of the GWAS is relatively small, the standard error of total\nSNP-heritability estimates of HESS can be large, which could then lead to\nlarge standard error in the local estimates. However, if an estimate of total\nSNP-heritability is available, then one may use the following script to\ndecompose the total SNP-heritability into each locus.  python hess.py --prefix step1 --tot-hsqg  total SNP-heritability   SE  --out step2  It is recommended to use the following code if the GWAS summary stats are\ncorrected for \\(\\lambda_{GC}\\).  python hess.py --prefix step1 --reinflate-lambda-gc  lambda gc to reinflate  \\\n               --tot-hsqg  total SNP-heritability   SE  --out step2", 
            "title": "Running the tool (using total SNP-heritability)"
        }, 
        {
            "location": "/local_hsqg/#other-available-flags", 
            "text": "--max-num-eig : Specifies the number of eigenvectors to use in the\ntruncated-SVD for inverting the LD matrix, default 50  --min-eigval : Specifies the minimum eigenvalue cut off in\ntruncated-SVD, default 1.0  --reinflate-lambda-gc : Specifies the genomic control factor that has been\napplied to the summary statistics, default 1.0  --gwse-thres : A threshold to cap the standard error of total\nSNP-heritability estimate   \n(  Note : We recommend to run HESS on GWAS summary statistics that has\nnot been applied the genomic control factor, which could results in downward\nbias. )  We provide a simple script ( misc/estimate_lambdagc.py ) to infer the genomic\ncontrol factor to reinflate the summary statistics if it is unknown. The\nfollowing script should be executed after step 1 completes.  python misc/estimate_lambdagc.py --prefix step1", 
            "title": "Other available flags"
        }, 
        {
            "location": "/local_hsqg/#interpreting-the-output_1", 
            "text": "After step 2, 2 files will be created. These include   step2.txt : contains local SNP-heritability estimates for all loci across all\nchromosomes. The columns are chromosome number, locus start position, locus\nend position, number of SNPs in locus, number of eigenvectors used\nin truncated-SVD, estimates of local SNP-heritability, estimated variance\nof the local SNP-heritability. We also report standard error and test\nstatistics.   chr start       end         num_snp k   local_h2g   var         se          z           p\n1   10583       1892607     1286    50  0.0001293   1.2819e-08  0.00011322  1.142       0.12673\n1   1892607     3582736     3045    50  0.0003232   2.7102e-08  0.00016463  1.9632      0.024809\n1   3582736     4380811     1622    50  6.7587e-05  1.282e-08   0.00011323  0.59692     0.27528\n1   4380811     5913893     3790    50  3.1445e-05  2.6111e-08  0.00016159  0.1946      0.42285\n... ...         ...         ...     ... ...         ...         ...         ...         ...\n22  46470495    47596318    2444    50  0.00018004  2.0125e-08  0.00014186  1.2691      0.1022\n22  47596318    48903703    2997    50  8.389e-05   2.4784e-08  0.00015743  0.53287     0.29706\n22  48903703    49824534    3773    50  6.9487e-06  2.5931e-08  0.00016103  0.043151    0.48279\n22  49824534    51243298    2789    50  0.00015227  2.4024e-08  0.000155    0.98241     0.16295   step2.log : contains useful information for debugging   [INFO] Command started at: Tue, 03 Oct 2017 21:01:34\n[INFO] Command issued:\n    /u/project/pasaniuc/shihuwen/software/hess/hess.py \\\n        --prefix ... \\\n        --out ...\n[INFO] Loaded results for ... loci from step 1\n[INFO] Using 4381458 SNPs with average sample size ...\n[INFO] Re-inflate the summary statistics with lambda_gc: ...\n[INFO] Total SNP-heritability estimate: ...\n[INFO] Command finished at: ...", 
            "title": "Interpreting the output"
        }, 
        {
            "location": "/local_rhog/", 
            "text": "Estimating local genetic covariance and correlation (\\(\\rho\\)-HESS)\n\n\nThis page describes the steps to estimate local genetic covariance and\ncorrelation from GWAS summary association data. In the first step,\nHESS computes the eigenvalues of LD matrices, the squared projections of\nGWAS effect size vector onto the eigenvectors of LD matrices for each trait,\nand the product of projections of GWAS effect size vectors onto the\neigenvectors. In the second step, HESS uses the output from step 1 to\nobtain estimates of local SNP-heritability of each trait. In the third step,\nHESS, uses output from step 2 to obtain local genetic covariance estimates\nand their standard errors.\n\n\nStep 1 - compute eigenvalues, squared projections, and product of projections\n\n\nRunning the tool\n\n\nIn this step, HESS computes eigenvalues, squared and product of projections of\nGWAS effect size vector of each trait onto the eigenvectors of LD matrices.\nThe following code provides an example of how to perform this step.\n\n\nfor chrom in $(seq 22)\ndo\n    python hess.py \\\n        --local-rhog \nsummary stats for trait 1\n \nsummary stats for trait 2\n \\\n        --chrom $chrom \\\n        --bfile \nreference panel in PLINK format for the specific chromosome\n \\\n        --partition \ngenome partition file for the specific chromosome\n \\\n        --out step1\ndone\n\n\n\n\n\nIn the command above, \n--local-rhog\n tells HESS to estimate local\ngenetic covariance, and is used to specify GWAS summary statistics data for\ntwo traits; \n--chrom\n is used to specify the chromosome number; \n--bfile\n is\nused to specify the reference panel for the corresponding chromsome;\n\n--partition\n is used to specify the genome partition file; \n--out\n is used\nto specify the prefix of the output file. For input file format, please refer\nto \nInput Format\n.\n\n\n\n( \nNote\n: The above for loop can be parallelized by chromosome in case a\ncomputer cluster is available. In addition, users can specify the minimum\nminor allele frequency (MAF) of the SNPs used for estimation through the\n\"--min-maf\" flag. The default MAF threshold is 0.05. )\n\n\n\n\nInterpreting the output\n\n\nAfter executing the command above, 9 files will be created for each\nchromosome (i.e. 198 files for all 22 chromosomes in total). The following is\nan example output obtained for chromosome 22. The format of the output files\nare identical to the output of\n\nlocal SNP-heritability analysis\n.\n\n\nThe following two files will be used in the 3rd step to estimate local\ngenetic covariance.\n\n\n\n\nstep1_chr22.eig.gz\n - contains the eigenvalues of LD matrix at each locus\n\n\nstep1_chr22.prjprod.gz\n - contains the product of projections\n\n\n\n\nThe following three files will be used in the 2nd step to estimate local\nSNP-heritability of trait 1\n\n\n\n\nstep1_trait1_chr22.eig.gz\n - contains the eigenvalues of LD matrix at each locus\n\n\nstep1_trait1_chr22.info.gz\n - contains information of each locus\n\n\nstep1_trait1_chr22.prjsq.gz\n - contains the squared projections\n\n\n\n\nThe following three files are the same type of files as the previous three\nfiles, and will be used in the 2nd step to estimate local SNP-heritability\nof trait 2\n\n\n\n\nstep1_trait2_chr22.eig.gz\n - contains the eigenvalues of LD matrix of each locus\n\n\nstep1_trait2_chr22.info.gz\n - contains information of each locus\n\n\nstep1_trait2_chr22.prjsq.gz\n - contains the squared projections\n\n\n\n\nIn addition, a log file \nstep1_trait2_chr22.log\n will be created to document\nthe details of each step.\n\n\nStep 2 - estimate local SNP-heritability of each trait\n\n\nRunning the tool\n\n\nIn this step, we estimate local SNP-heritability for trait 1 and trait 2 using\noutput from step 1. The following script provide an example of how to perform\nthis step. Please see \nlocal SNP-heritability analysis\n\nfor more detail.\n\n\n# estimate local SNP-heritability for trait 1\npython hess.py --prefix step1_trait1 --out step2_trait1\n\n# estimate local SNP-heritability for trait 2\npython hess.py --prefix step1_trait2 --out step2_trait2\n\n\n\n\n\nNote on re-inflating \\(\\lambda_{GC}\\)\n\n\nMost GWAS summary stats are corrected for genomic control factor\n\\(\\lambda_{GC}\\). This could result in a downward bias in the estimated\nSNP-heritability. If the GWAS summary stats has been corrected for\n\\(\\lambda_{GC}\\), it is recommended to use the following code to perform\nstep 2.\n\n\n# estimate local SNP-heritability for trait 1\npython hess.py --prefix step1_trait1 --reinflate-lambda-gc \nlambda gc to reinflate for trait 1\n \\\n               --out step2_trait1\n\n# estimate local SNP-heritability for trait 2\npython hess.py --prefix step1_trait2 --reinflate-lambda-gc \nlambda gc to reinflate for trait 2\n \\\n               --out step2_trait2\n\n\n\n\n\nInterpreting the output\n\n\nThe above command will result in 4 files, 2 for each trait, containing local\nSNP-heritability estimates at each locus.\n\n\n\n\nstep2_trait1.txt\n - contains local SNP-heritability estimates at each locus for trait 1\n\n\nstep2_trait2.txt\n - contains local SNP-heritability estimates at each locus for trait 2\n\n\n\n\nIn addition, 2 log files will also be created.\n\n\n\n\nstep2_trait1.log\n - contains debugging information for trait 1\n\n\nstep2_trait2.log\n - contains debugging information for trait 2\n\n\n\n\nPlease see \nlocal SNP-heritability analysis\n\nfor more detail.\n\n\nStep 3 - estimate local genetic covariance and standard error\n\n\nEstimate phenotypic correlation\n\n\n\\(\\rho\\)-HESS requires phenotypic correlation between a pair of traits to\nobtain an unbiased estimates of local genetic covariance. If phenotypic data\nof the GWAS is available, we recommend to obtain phenotypic correlation of\nthe pair of traits by taking the Pearson correlation between the phenotype\nvalues of the two traits.\n\n\nIf individual-level phenotype data are not available, one can obtain an\nestimate through\n\ncross-trait LDSC\n.\nThe intercept term corresponding to the genetic covariance estimates provides\nan approximation of phenotypic correlation. More precisely, the estimated \nphenotypic correlation \\(r_{pheno}\\) is\n\\[\n    r_{pheno} =  \\delta \\times \\sqrt{N_1 N_2} / N_s,\n\\]\nwhere \\(\\delta\\) is the intercept term, \\(N_1\\) and \\(N_2\\) sample\nsize for the two GWAS, and \\(N_s\\) number of shared samples between the\ntwo GWASs.\n\n\nWe provide a simple script (\nmisc/estimate_phenocor.py\n) for obtaining \nphenotypic correlation from cross-trait LDSC log files.\n\n\npython misc/estimate_phenocor.py \\\n    --ldsc-log \ncross-trait LDSC log file\n \\\n    --n1 \nsample size for GWAS 1\n --n2 \nsample size for GWAS 2\n \\\n    --ns \nnumber of shared samples\n\n\n\n\n\n\n\n( \nNote\n: If there is no sample overlap between the two GWASs, then\none does not need to estimate phenotypic correlation. This is because bias\nin local genetic covariance estimate are caused by environmental covariance\ncoming from overlapping GWAS samples. And one needs to know the phenotypic\ncorrelation to infer environmental covariance. When there is no sample\noverlap, there is no need to correct for bias caused by environmental\ncovariance. )\n\n\n\n\n\n( \nNote\n: The cross-trait LDSC intercept here should correspond to\ngenetic covariance and not SNP-heritability. )\n\n\n\n\nRunning the tool\n\n\nThe following script combines output from step 1 and step 2 to obtain local\ngenetic covariance estimates.\n\n\npython hess.py \\\n    --prefix step1 \\\n    --local-hsqg-est step2_trait1.txt step2_trait2.txt \\\n    --num-shared \nnumber of overlapping samples in the two GWASs\n \\\n    --pheno-cor \nphenotypic correlation between the two traits\n \\\n    --out step3\n\n\n\n\n\n\n( \nNote\n: When \"--num-shared\" is set to zero, \"--pheno-cor\" can be\nset to any value (e.g. 0.0) and the result will not be affected. Also, note\nthat no for loop is required here. \n-HESS will automatically look\nfor output from all chromosomes.)\n\n\n\n\nNote on re-inflating \\(\\lambda_{GC}\\)\n\n\nMost GWAS summary stats are corrected for genomic control factor\n\\(\\lambda_{GC}\\). This could result in a downward bias in the estimated\nSNP-heritability. If the GWAS summary stats has been corrected for\n\\(\\lambda_{GC}\\), it is recommended to use the following code to perform\nstep 2.\n\n\npython hess.py \\\n    --prefix step1 \\\n    --local-hsqg-est step2_trait1.txt step2_trait2.txt \\\n    --reinflate-lambda-gc \nlambda gc to reinflate for trait 1\n \nlambda gc to reinflate for trait 2\n \\\n    --num-shared \nnumber of overlapping samples in the two GWASs\n \\\n    --pheno-cor \nphenotypic correlation between the two traits\n \\\n    --out step3\n\n\n\n\n\nOther available flags\n\n\n\n\n--max-num-eig\n: Specifies the number of eigenvectors to use in the\ntruncated-SVD for inverting the LD matrix, default 50\n\n\n--min-eigval\n: Specifies the minimum eigenvalue cut off in\ntruncated-SVD, default 1.0\n\n\n--reinflate-lambda-gc\n: Genomic control factors that have been applied to\nthe summary statistics, default 1.0 for both\n\n\n--gwse-thres\n: A threshold to cap the standard error of total\nSNP-heritability estimate\n\n\n\n\nInterpreting the output\n\n\nAfter step3, 2 files will be created. These include\n\n\n\n\nstep3.txt\n - contains the local genetic covariance estimates across\nthe entire genome. The columns are chromosome, start and end positions of\nthe locus, number of SNPs in the locus, number of eigenvectors used in the\ntruncated-SVD, local genetic covariance estimates, and variance estimates.\nWe also report the standard error and test statistics.\n\n\n\n\nchr  start     end         num_snp k    local_rhog    var          se           z            p\n1    10583     1892607     1286    50   1.3906e-06    2.1507e-09   4.6375e-05   0.029985     0.97608\n1    1892607   3582736     3045    50   -3.2351e-05   4.0829e-09   6.3898e-05   -0.50629     0.61265\n1    3582736   4380811     1622    50   0.00011446    2.9594e-09   5.44e-05     2.104        0.035379\n1    4380811   5913893     3790    50   -1.898e-06    3.3276e-09   5.7685e-05   -0.032903    0.97375\n...  ...       ...         ...     ...  ...           ...          ...          ...          ...\n22   46470495  47596318    2444    50   -1.8303e-05   2.7353e-09   5.23e-05     -0.34997     0.72636\n22   47596318  48903703    2997    50   -4.6613e-06   3.1558e-09   5.6176e-05   -0.082977    0.93387\n22   48903703  49824534    3773    50   -1.261e-06    3.2769e-09   5.7245e-05   -0.022028    0.98243\n22   49824534  51243298    2789    50   6.7939e-05    3.8538e-09   6.2079e-05   1.0944       0.27378\n\n\n\n\n\n\n\nstep3.log\n - contains estimates of genome-wide genetic covariance and\ncorrelation and information useful for debugging\n\n\n\n\n[INFO] Command started at: Wed, 04 Oct 2017 00:29:13\n[INFO] Command issued:\n[INFO] Total SNP-heritability of trait 1: ...\n[INFO] Total SNP-heritability of trait 2: ...\n                    ...\n[INFO] Genome-wide genetic covariance estimate: ...\n[INFO] Genome-wide genetic correlation estimate: ...\n[INFO] Command finished at: ...\n\n\n\n\n\n\n( \nNote\n: We estimate the standard error of genome-wide genetic correlation\nthrough jackknife.)", 
            "title": "Local genetic covariance (correlation)"
        }, 
        {
            "location": "/local_rhog/#estimating-local-genetic-covariance-and-correlation-92rho92-hess", 
            "text": "This page describes the steps to estimate local genetic covariance and\ncorrelation from GWAS summary association data. In the first step,\nHESS computes the eigenvalues of LD matrices, the squared projections of\nGWAS effect size vector onto the eigenvectors of LD matrices for each trait,\nand the product of projections of GWAS effect size vectors onto the\neigenvectors. In the second step, HESS uses the output from step 1 to\nobtain estimates of local SNP-heritability of each trait. In the third step,\nHESS, uses output from step 2 to obtain local genetic covariance estimates\nand their standard errors.", 
            "title": "Estimating local genetic covariance and correlation (\\(\\rho\\)-HESS)"
        }, 
        {
            "location": "/local_rhog/#step-1-compute-eigenvalues-squared-projections-and-product-of-projections", 
            "text": "", 
            "title": "Step 1 - compute eigenvalues, squared projections, and product of projections"
        }, 
        {
            "location": "/local_rhog/#running-the-tool", 
            "text": "In this step, HESS computes eigenvalues, squared and product of projections of\nGWAS effect size vector of each trait onto the eigenvectors of LD matrices.\nThe following code provides an example of how to perform this step.  for chrom in $(seq 22)\ndo\n    python hess.py \\\n        --local-rhog  summary stats for trait 1   summary stats for trait 2  \\\n        --chrom $chrom \\\n        --bfile  reference panel in PLINK format for the specific chromosome  \\\n        --partition  genome partition file for the specific chromosome  \\\n        --out step1\ndone  In the command above,  --local-rhog  tells HESS to estimate local\ngenetic covariance, and is used to specify GWAS summary statistics data for\ntwo traits;  --chrom  is used to specify the chromosome number;  --bfile  is\nused to specify the reference panel for the corresponding chromsome; --partition  is used to specify the genome partition file;  --out  is used\nto specify the prefix of the output file. For input file format, please refer\nto  Input Format .  \n(  Note : The above for loop can be parallelized by chromosome in case a\ncomputer cluster is available. In addition, users can specify the minimum\nminor allele frequency (MAF) of the SNPs used for estimation through the\n\"--min-maf\" flag. The default MAF threshold is 0.05. )", 
            "title": "Running the tool"
        }, 
        {
            "location": "/local_rhog/#interpreting-the-output", 
            "text": "After executing the command above, 9 files will be created for each\nchromosome (i.e. 198 files for all 22 chromosomes in total). The following is\nan example output obtained for chromosome 22. The format of the output files\nare identical to the output of local SNP-heritability analysis .  The following two files will be used in the 3rd step to estimate local\ngenetic covariance.   step1_chr22.eig.gz  - contains the eigenvalues of LD matrix at each locus  step1_chr22.prjprod.gz  - contains the product of projections   The following three files will be used in the 2nd step to estimate local\nSNP-heritability of trait 1   step1_trait1_chr22.eig.gz  - contains the eigenvalues of LD matrix at each locus  step1_trait1_chr22.info.gz  - contains information of each locus  step1_trait1_chr22.prjsq.gz  - contains the squared projections   The following three files are the same type of files as the previous three\nfiles, and will be used in the 2nd step to estimate local SNP-heritability\nof trait 2   step1_trait2_chr22.eig.gz  - contains the eigenvalues of LD matrix of each locus  step1_trait2_chr22.info.gz  - contains information of each locus  step1_trait2_chr22.prjsq.gz  - contains the squared projections   In addition, a log file  step1_trait2_chr22.log  will be created to document\nthe details of each step.", 
            "title": "Interpreting the output"
        }, 
        {
            "location": "/local_rhog/#step-2-estimate-local-snp-heritability-of-each-trait", 
            "text": "", 
            "title": "Step 2 - estimate local SNP-heritability of each trait"
        }, 
        {
            "location": "/local_rhog/#running-the-tool_1", 
            "text": "In this step, we estimate local SNP-heritability for trait 1 and trait 2 using\noutput from step 1. The following script provide an example of how to perform\nthis step. Please see  local SNP-heritability analysis \nfor more detail.  # estimate local SNP-heritability for trait 1\npython hess.py --prefix step1_trait1 --out step2_trait1\n\n# estimate local SNP-heritability for trait 2\npython hess.py --prefix step1_trait2 --out step2_trait2", 
            "title": "Running the tool"
        }, 
        {
            "location": "/local_rhog/#note-on-re-inflating-92lambda_gc92", 
            "text": "Most GWAS summary stats are corrected for genomic control factor\n\\(\\lambda_{GC}\\). This could result in a downward bias in the estimated\nSNP-heritability. If the GWAS summary stats has been corrected for\n\\(\\lambda_{GC}\\), it is recommended to use the following code to perform\nstep 2.  # estimate local SNP-heritability for trait 1\npython hess.py --prefix step1_trait1 --reinflate-lambda-gc  lambda gc to reinflate for trait 1  \\\n               --out step2_trait1\n\n# estimate local SNP-heritability for trait 2\npython hess.py --prefix step1_trait2 --reinflate-lambda-gc  lambda gc to reinflate for trait 2  \\\n               --out step2_trait2", 
            "title": "Note on re-inflating \\(\\lambda_{GC}\\)"
        }, 
        {
            "location": "/local_rhog/#interpreting-the-output_1", 
            "text": "The above command will result in 4 files, 2 for each trait, containing local\nSNP-heritability estimates at each locus.   step2_trait1.txt  - contains local SNP-heritability estimates at each locus for trait 1  step2_trait2.txt  - contains local SNP-heritability estimates at each locus for trait 2   In addition, 2 log files will also be created.   step2_trait1.log  - contains debugging information for trait 1  step2_trait2.log  - contains debugging information for trait 2   Please see  local SNP-heritability analysis \nfor more detail.", 
            "title": "Interpreting the output"
        }, 
        {
            "location": "/local_rhog/#step-3-estimate-local-genetic-covariance-and-standard-error", 
            "text": "", 
            "title": "Step 3 - estimate local genetic covariance and standard error"
        }, 
        {
            "location": "/local_rhog/#estimate-phenotypic-correlation", 
            "text": "\\(\\rho\\)-HESS requires phenotypic correlation between a pair of traits to\nobtain an unbiased estimates of local genetic covariance. If phenotypic data\nof the GWAS is available, we recommend to obtain phenotypic correlation of\nthe pair of traits by taking the Pearson correlation between the phenotype\nvalues of the two traits.  If individual-level phenotype data are not available, one can obtain an\nestimate through cross-trait LDSC .\nThe intercept term corresponding to the genetic covariance estimates provides\nan approximation of phenotypic correlation. More precisely, the estimated \nphenotypic correlation \\(r_{pheno}\\) is\n\\[\n    r_{pheno} =  \\delta \\times \\sqrt{N_1 N_2} / N_s,\n\\]\nwhere \\(\\delta\\) is the intercept term, \\(N_1\\) and \\(N_2\\) sample\nsize for the two GWAS, and \\(N_s\\) number of shared samples between the\ntwo GWASs.  We provide a simple script ( misc/estimate_phenocor.py ) for obtaining \nphenotypic correlation from cross-trait LDSC log files.  python misc/estimate_phenocor.py \\\n    --ldsc-log  cross-trait LDSC log file  \\\n    --n1  sample size for GWAS 1  --n2  sample size for GWAS 2  \\\n    --ns  number of shared samples   \n(  Note : If there is no sample overlap between the two GWASs, then\none does not need to estimate phenotypic correlation. This is because bias\nin local genetic covariance estimate are caused by environmental covariance\ncoming from overlapping GWAS samples. And one needs to know the phenotypic\ncorrelation to infer environmental covariance. When there is no sample\noverlap, there is no need to correct for bias caused by environmental\ncovariance. )  \n(  Note : The cross-trait LDSC intercept here should correspond to\ngenetic covariance and not SNP-heritability. )", 
            "title": "Estimate phenotypic correlation"
        }, 
        {
            "location": "/local_rhog/#running-the-tool_2", 
            "text": "The following script combines output from step 1 and step 2 to obtain local\ngenetic covariance estimates.  python hess.py \\\n    --prefix step1 \\\n    --local-hsqg-est step2_trait1.txt step2_trait2.txt \\\n    --num-shared  number of overlapping samples in the two GWASs  \\\n    --pheno-cor  phenotypic correlation between the two traits  \\\n    --out step3  \n(  Note : When \"--num-shared\" is set to zero, \"--pheno-cor\" can be\nset to any value (e.g. 0.0) and the result will not be affected. Also, note\nthat no for loop is required here.  -HESS will automatically look\nfor output from all chromosomes.)", 
            "title": "Running the tool"
        }, 
        {
            "location": "/local_rhog/#note-on-re-inflating-92lambda_gc92_1", 
            "text": "Most GWAS summary stats are corrected for genomic control factor\n\\(\\lambda_{GC}\\). This could result in a downward bias in the estimated\nSNP-heritability. If the GWAS summary stats has been corrected for\n\\(\\lambda_{GC}\\), it is recommended to use the following code to perform\nstep 2.  python hess.py \\\n    --prefix step1 \\\n    --local-hsqg-est step2_trait1.txt step2_trait2.txt \\\n    --reinflate-lambda-gc  lambda gc to reinflate for trait 1   lambda gc to reinflate for trait 2  \\\n    --num-shared  number of overlapping samples in the two GWASs  \\\n    --pheno-cor  phenotypic correlation between the two traits  \\\n    --out step3", 
            "title": "Note on re-inflating \\(\\lambda_{GC}\\)"
        }, 
        {
            "location": "/local_rhog/#other-available-flags", 
            "text": "--max-num-eig : Specifies the number of eigenvectors to use in the\ntruncated-SVD for inverting the LD matrix, default 50  --min-eigval : Specifies the minimum eigenvalue cut off in\ntruncated-SVD, default 1.0  --reinflate-lambda-gc : Genomic control factors that have been applied to\nthe summary statistics, default 1.0 for both  --gwse-thres : A threshold to cap the standard error of total\nSNP-heritability estimate", 
            "title": "Other available flags"
        }, 
        {
            "location": "/local_rhog/#interpreting-the-output_2", 
            "text": "After step3, 2 files will be created. These include   step3.txt  - contains the local genetic covariance estimates across\nthe entire genome. The columns are chromosome, start and end positions of\nthe locus, number of SNPs in the locus, number of eigenvectors used in the\ntruncated-SVD, local genetic covariance estimates, and variance estimates.\nWe also report the standard error and test statistics.   chr  start     end         num_snp k    local_rhog    var          se           z            p\n1    10583     1892607     1286    50   1.3906e-06    2.1507e-09   4.6375e-05   0.029985     0.97608\n1    1892607   3582736     3045    50   -3.2351e-05   4.0829e-09   6.3898e-05   -0.50629     0.61265\n1    3582736   4380811     1622    50   0.00011446    2.9594e-09   5.44e-05     2.104        0.035379\n1    4380811   5913893     3790    50   -1.898e-06    3.3276e-09   5.7685e-05   -0.032903    0.97375\n...  ...       ...         ...     ...  ...           ...          ...          ...          ...\n22   46470495  47596318    2444    50   -1.8303e-05   2.7353e-09   5.23e-05     -0.34997     0.72636\n22   47596318  48903703    2997    50   -4.6613e-06   3.1558e-09   5.6176e-05   -0.082977    0.93387\n22   48903703  49824534    3773    50   -1.261e-06    3.2769e-09   5.7245e-05   -0.022028    0.98243\n22   49824534  51243298    2789    50   6.7939e-05    3.8538e-09   6.2079e-05   1.0944       0.27378   step3.log  - contains estimates of genome-wide genetic covariance and\ncorrelation and information useful for debugging   [INFO] Command started at: Wed, 04 Oct 2017 00:29:13\n[INFO] Command issued:\n[INFO] Total SNP-heritability of trait 1: ...\n[INFO] Total SNP-heritability of trait 2: ...\n                    ...\n[INFO] Genome-wide genetic covariance estimate: ...\n[INFO] Genome-wide genetic correlation estimate: ...\n[INFO] Command finished at: ...  \n(  Note : We estimate the standard error of genome-wide genetic correlation\nthrough jackknife.)", 
            "title": "Interpreting the output"
        }, 
        {
            "location": "/viz/", 
            "text": "Visualizing local estimates\n\n\nThis page describes script to visualize local SNP-heritability estimates\nand local genetic covariance estimates.\n\n\nLocal SNP-heritability estimates\n\n\nWe provide script (\nmisc/local_hsqg_manhattan.py\n) that makes Manhattan-style\nplot for visualizing local SNP-heritability estimates. The script can be\nexecuted as follows.\n\n\npython misc/local_hsqg_manhattan.py \\\n    --local-hsqg-est \nlocal SNP-heritability output\n \\\n    --out \noutput file name e.g. trait1_local_hsqg.pdf\n \\\n    --trait-name TRAIT1\n\n\n\n\n\nThere following is an example figure generated by the visualization tool.\nHere, colored bars represent loci that have significant local SNP-heritability.\n\n\n\n\nLocal genetic covariance estimates\n\n\nWe provide script (\nmisc/local_rhog_manhattan.py\n) that makes Manhattan-style\nplot for visualizing local genetic covariance estimates. The script can be\nexecuted as follows.\n\n\npython misc/local_rhog_manhattan.py \\\n    --local-rhog-est \nlocal genetic covariance estimates output\n \\\n    --local-hsqg-est \nlocal SNP-heritability output trait 1\n  \nlocal SNP-heritability output trait 2\n \\\n    --out \noutput file name e.g. trait1_trait2_local_rhog.pdf\n \\\n    --trait-names TRAIT1 TRAIT2\n\n\n\n\n\nSimilarly, colored bars represent loci that have significant local genetic covariance.", 
            "title": "Visualizing local estimates"
        }, 
        {
            "location": "/viz/#visualizing-local-estimates", 
            "text": "This page describes script to visualize local SNP-heritability estimates\nand local genetic covariance estimates.", 
            "title": "Visualizing local estimates"
        }, 
        {
            "location": "/viz/#local-snp-heritability-estimates", 
            "text": "We provide script ( misc/local_hsqg_manhattan.py ) that makes Manhattan-style\nplot for visualizing local SNP-heritability estimates. The script can be\nexecuted as follows.  python misc/local_hsqg_manhattan.py \\\n    --local-hsqg-est  local SNP-heritability output  \\\n    --out  output file name e.g. trait1_local_hsqg.pdf  \\\n    --trait-name TRAIT1  There following is an example figure generated by the visualization tool.\nHere, colored bars represent loci that have significant local SNP-heritability.", 
            "title": "Local SNP-heritability estimates"
        }, 
        {
            "location": "/viz/#local-genetic-covariance-estimates", 
            "text": "We provide script ( misc/local_rhog_manhattan.py ) that makes Manhattan-style\nplot for visualizing local genetic covariance estimates. The script can be\nexecuted as follows.  python misc/local_rhog_manhattan.py \\\n    --local-rhog-est  local genetic covariance estimates output  \\\n    --local-hsqg-est  local SNP-heritability output trait 1    local SNP-heritability output trait 2  \\\n    --out  output file name e.g. trait1_trait2_local_rhog.pdf  \\\n    --trait-names TRAIT1 TRAIT2  Similarly, colored bars represent loci that have significant local genetic covariance.", 
            "title": "Local genetic covariance estimates"
        }, 
        {
            "location": "/contrast_polygenicity/", 
            "text": "Contrast polygenicity\n\n\nWe provide script (\nmisc/contrast_polygenicity.py\n) to make the plot for\ncontrasting degrees of polygenicity between traits. The script can be\nexecuted as follows.\n\n\nInput\n\n\n\n\nLocal SNP-heritability estimates for a number of traits.\n\n\n\n\nWe recommend to plot less than 10 traits at a time.\n\n\nExample\n\n\nThe following is an example script to create the contrast polygenicity plot.\n\n\npython $src/contrast_polygenicity.py \\\n    --local-hsqg-est \nlocal SNP-heritability output trait 1\n  \nlocal SNP-heritability output trait 1\n \\\n    --show-se --no-negative --trait-names TRAIT1 TRAIT2 \\\n    --out \noutput file name e.g. trait1_trait2_contrast.pdf\n\n\n\n\n\n\nHere \n--no-negative\n enforces any negative local estimates to 0.0\nStandard error shade can be turned off by removing the \n--show-se\n flag.\n\n\nThe following is an example output figure.", 
            "title": "Contrast polygenicity"
        }, 
        {
            "location": "/contrast_polygenicity/#contrast-polygenicity", 
            "text": "We provide script ( misc/contrast_polygenicity.py ) to make the plot for\ncontrasting degrees of polygenicity between traits. The script can be\nexecuted as follows.", 
            "title": "Contrast polygenicity"
        }, 
        {
            "location": "/contrast_polygenicity/#input", 
            "text": "Local SNP-heritability estimates for a number of traits.   We recommend to plot less than 10 traits at a time.", 
            "title": "Input"
        }, 
        {
            "location": "/contrast_polygenicity/#example", 
            "text": "The following is an example script to create the contrast polygenicity plot.  python $src/contrast_polygenicity.py \\\n    --local-hsqg-est  local SNP-heritability output trait 1    local SNP-heritability output trait 1  \\\n    --show-se --no-negative --trait-names TRAIT1 TRAIT2 \\\n    --out  output file name e.g. trait1_trait2_contrast.pdf   Here  --no-negative  enforces any negative local estimates to 0.0\nStandard error shade can be turned off by removing the  --show-se  flag.  The following is an example output figure.", 
            "title": "Example"
        }, 
        {
            "location": "/infer_causality/", 
            "text": "Infer putative causality\n\n\nThis page describes script (\nmisc/infer_putative_causality.py\n) for inferring\nputative causality between a pair of traits.\n\n\nInput\n\n\n\n\nLocal genetic covariance estimates for a pair of traits\n\n\nLocal SNP-heritability estimates for both traits\n\n\nGWAS hits for both traits in the following format\n\n\n\n\nCHR  BP\n1    1124974\n1    1146785\n1    1146853\n1    1151679\n...  ...\n22   50570755\n22   50622404\n22   50628937\n22   50656109\n\n\n\n\n\nExample\n\n\nThe following script computes local genetic correlation at loci ascertained\nfor GWAS hits specific to trait 1 and trait 2.\n\n\npython $src/infer_putative_causality.py \\\n    --local-rhog-est \nlocal genetic covariance output\n \\\n    --local-hsqg-est \nlocal SNP-heritability output trait 1\n \nlocal SNP-heritability output trait 2\n \\\n    --trait-names TRAIT1 TRAIT2 \\\n    --gwas-loci \ntrait 1 GWAS hits\n \ntrait 2 GWAS hits\n \\\n    --out \noutput file name e.g. trait1_trait2_causality.pdf\n \n\n\n\n\n\nThe following is an example output. In addition, a log file containing local\ngenetic correlation estimates will be created.\n\n\ntrait1  local_gcor1  local_gcor1_se  trait2  local_gcor2  local_gcor2_se\nTRAIT1  0.006        0.021           TRAIT2  0.07         0.02", 
            "title": "Infer putative causality"
        }, 
        {
            "location": "/infer_causality/#infer-putative-causality", 
            "text": "This page describes script ( misc/infer_putative_causality.py ) for inferring\nputative causality between a pair of traits.", 
            "title": "Infer putative causality"
        }, 
        {
            "location": "/infer_causality/#input", 
            "text": "Local genetic covariance estimates for a pair of traits  Local SNP-heritability estimates for both traits  GWAS hits for both traits in the following format   CHR  BP\n1    1124974\n1    1146785\n1    1146853\n1    1151679\n...  ...\n22   50570755\n22   50622404\n22   50628937\n22   50656109", 
            "title": "Input"
        }, 
        {
            "location": "/infer_causality/#example", 
            "text": "The following script computes local genetic correlation at loci ascertained\nfor GWAS hits specific to trait 1 and trait 2.  python $src/infer_putative_causality.py \\\n    --local-rhog-est  local genetic covariance output  \\\n    --local-hsqg-est  local SNP-heritability output trait 1   local SNP-heritability output trait 2  \\\n    --trait-names TRAIT1 TRAIT2 \\\n    --gwas-loci  trait 1 GWAS hits   trait 2 GWAS hits  \\\n    --out  output file name e.g. trait1_trait2_causality.pdf    The following is an example output. In addition, a log file containing local\ngenetic correlation estimates will be created.  trait1  local_gcor1  local_gcor1_se  trait2  local_gcor2  local_gcor2_se\nTRAIT1  0.006        0.021           TRAIT2  0.07         0.02", 
            "title": "Example"
        }, 
        {
            "location": "/faq/", 
            "text": "Frequently Asked Questions\n\n\nThis page addresses some frequently asked questions from users.\nMost of the question that applies to HESS also applies to \\(\\rho\\)-HESS.\n\n\nWhat is the sample size requirement for HESS?\n\n\nWe recommend to apply HESS on GWAS with sample size greater\nthan 50,000. HESS tends to be downwardly biased at smaller\nGWAS since fewer eigenvectors are necessary in the truncated-SVD\nregularization to obtain a stable estimate.\n\n\nOn the other hand, if genome-wide SNP-heritability is available for the GWAS\n(e.g. estimated from individual-level data), then it may still be possible to\nobtain the local estimates\n(see \nhere\n).\n\n\nWhy is it necessary to re-inflate genomic control factor?\n\n\nMost GWAS studies apply genomic control factor (\\(\\lambda_{GC}\\)) on the\nassociation statistics. This could result in a downward bias in the estimated\nheritability since the second step of HESS involves an estimation of the\nenvironmental effect variance (\\(\\sigma_e^2\\)) -- with \\(\\lambda_{GC}\\)\ncorrected GWAS summary stats, HESS tends to overestimate \\(\\sigma_e^2\\),\nresulting in downward bias in local SNP-heritability.\n\n\nSee \nhere\n\nfor how to specify \\(\\lambda_{GC}\\) in estimating local SNP-heritability,\nand \nhere\n\nfor genetic covariance.\n\n\nWhy do I get negative local SNP-heritability estimates?\n\n\nLocal SNP-heritability are not constrained to be greater than 0, so that if a locus\ntruly has zero SNP-heritability, then HESS can give a zero estimation in the expectation.\n\n\nIf a locus has negative SNP-heritability estimate, then this is likely because the\nlocal SNP-heritability of the trait is close to zero.\n\n\nWhy do I get NaN for genome-wide SNP-heritability variance estimates?\n\n\nThis is because the estimated variance of the genome-wide SNP-heritability\nis negative, usually caused by relatively small sample size of the GWAS.\n\n\nWhy do I get negative variance estimates for local SNP-heritability / genetic covariance?\n\n\nThe variance estimates for local SNP-heritbility (genetic covariance) is a\nrandom variable that is not constrained to be positive. For some loci, the\nlocal SNP-heritability variance estimates may be negative.\n\n\nUsually, negative variance estimates are caused by relatively small sample\nsize of the GWAS.\n\n\nWhy does HESS give different estimate than LDSC?\n\n\nOverall, HESS and LDSC should give similar estimates. However, HESS and LDSC\nhave different definitions of SNP-heritability and genetic covariance. Also,\nunlike LDSC, HESS does not account for population stratification in the GWAS\nsummary stats. This could also cause the difference.\n\n\nWhat does the following error message mean?\n\n\nSome users experience the following error message in step 2 of the analysis.\n\n\n[ERROR] Rank of A less than the number of loci. There might be loci with no SNP.\n\n\n\n\n\nThe second step of HESS and \\(\\rho\\)-HESS involves inverting a matrix. If\nthe matrix is not invertible, HESS and \\(\\rho\\)-HESS will not attempt to\nestimate SNP-heritability or genetic covariance.\n\n\nUsually, this error is caused by empty locus (SNP with no SNP in it).\n\n\nIf there are empty loci in the data, it is recommended to remove these loci\nor combine these loci with nearby loci.\n\n\nWhat does the following error message mean?\n\n\nSome users experience the following error message in step 2 of the analysis.\n\n\nIOError: CRC check failed ...\n\n\n\n\n\nThis is usually caused by prematurely finished step 1.\n\n\nNote that step 1 usually involves inverting large matrices and may take quite\nbit of memory.", 
            "title": "FAQ"
        }, 
        {
            "location": "/faq/#frequently-asked-questions", 
            "text": "This page addresses some frequently asked questions from users.\nMost of the question that applies to HESS also applies to \\(\\rho\\)-HESS.", 
            "title": "Frequently Asked Questions"
        }, 
        {
            "location": "/faq/#what-is-the-sample-size-requirement-for-hess", 
            "text": "We recommend to apply HESS on GWAS with sample size greater\nthan 50,000. HESS tends to be downwardly biased at smaller\nGWAS since fewer eigenvectors are necessary in the truncated-SVD\nregularization to obtain a stable estimate.  On the other hand, if genome-wide SNP-heritability is available for the GWAS\n(e.g. estimated from individual-level data), then it may still be possible to\nobtain the local estimates\n(see  here ).", 
            "title": "What is the sample size requirement for HESS?"
        }, 
        {
            "location": "/faq/#why-is-it-necessary-to-re-inflate-genomic-control-factor", 
            "text": "Most GWAS studies apply genomic control factor (\\(\\lambda_{GC}\\)) on the\nassociation statistics. This could result in a downward bias in the estimated\nheritability since the second step of HESS involves an estimation of the\nenvironmental effect variance (\\(\\sigma_e^2\\)) -- with \\(\\lambda_{GC}\\)\ncorrected GWAS summary stats, HESS tends to overestimate \\(\\sigma_e^2\\),\nresulting in downward bias in local SNP-heritability.  See  here \nfor how to specify \\(\\lambda_{GC}\\) in estimating local SNP-heritability,\nand  here \nfor genetic covariance.", 
            "title": "Why is it necessary to re-inflate genomic control factor?"
        }, 
        {
            "location": "/faq/#why-do-i-get-negative-local-snp-heritability-estimates", 
            "text": "Local SNP-heritability are not constrained to be greater than 0, so that if a locus\ntruly has zero SNP-heritability, then HESS can give a zero estimation in the expectation.  If a locus has negative SNP-heritability estimate, then this is likely because the\nlocal SNP-heritability of the trait is close to zero.", 
            "title": "Why do I get negative local SNP-heritability estimates?"
        }, 
        {
            "location": "/faq/#why-do-i-get-nan-for-genome-wide-snp-heritability-variance-estimates", 
            "text": "This is because the estimated variance of the genome-wide SNP-heritability\nis negative, usually caused by relatively small sample size of the GWAS.", 
            "title": "Why do I get NaN for genome-wide SNP-heritability variance estimates?"
        }, 
        {
            "location": "/faq/#why-do-i-get-negative-variance-estimates-for-local-snp-heritability-genetic-covariance", 
            "text": "The variance estimates for local SNP-heritbility (genetic covariance) is a\nrandom variable that is not constrained to be positive. For some loci, the\nlocal SNP-heritability variance estimates may be negative.  Usually, negative variance estimates are caused by relatively small sample\nsize of the GWAS.", 
            "title": "Why do I get negative variance estimates for local SNP-heritability / genetic covariance?"
        }, 
        {
            "location": "/faq/#why-does-hess-give-different-estimate-than-ldsc", 
            "text": "Overall, HESS and LDSC should give similar estimates. However, HESS and LDSC\nhave different definitions of SNP-heritability and genetic covariance. Also,\nunlike LDSC, HESS does not account for population stratification in the GWAS\nsummary stats. This could also cause the difference.", 
            "title": "Why does HESS give different estimate than LDSC?"
        }, 
        {
            "location": "/faq/#what-does-the-following-error-message-mean", 
            "text": "Some users experience the following error message in step 2 of the analysis.  [ERROR] Rank of A less than the number of loci. There might be loci with no SNP.  The second step of HESS and \\(\\rho\\)-HESS involves inverting a matrix. If\nthe matrix is not invertible, HESS and \\(\\rho\\)-HESS will not attempt to\nestimate SNP-heritability or genetic covariance.  Usually, this error is caused by empty locus (SNP with no SNP in it).  If there are empty loci in the data, it is recommended to remove these loci\nor combine these loci with nearby loci.", 
            "title": "What does the following error message mean?"
        }, 
        {
            "location": "/faq/#what-does-the-following-error-message-mean_1", 
            "text": "Some users experience the following error message in step 2 of the analysis.  IOError: CRC check failed ...  This is usually caused by prematurely finished step 1.  Note that step 1 usually involves inverting large matrices and may take quite\nbit of memory.", 
            "title": "What does the following error message mean?"
        }
    ]
}